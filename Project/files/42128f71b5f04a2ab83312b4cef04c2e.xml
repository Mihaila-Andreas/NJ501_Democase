<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class DynListBox&#xD;
</HiddenHeader><SerialData i:nil="true"/><SerialDeviceHmiId i:nil="true"/><SerialScaleData i:nil="true"/><Text>&#xD;
'IAG Code behind - Add local subroutines for the IAG.&#xD;
&#xD;
Private container() As Object&#xD;
&#xD;
Private SelectedItem As String&#xD;
Private SelectedIndex As Integer&#xD;
&#xD;
Public ReadOnly Property Item As String&#xD;
   Get&#xD;
      Return Me.SelectedItem&#xD;
   End Get&#xD;
End Property&#xD;
&#xD;
&#xD;
Public Property Index As Integer&#xD;
   Get&#xD;
      Return Me.SelectedIndex&#xD;
   End Get&#xD;
   &#xD;
   Set(ByVal Value As Integer)&#xD;
      Me.SelectedIndex = Value&#xD;
	  ListBox0.selectedindex = SelectedIndex&#xD;
   End Set&#xD;
End Property&#xD;
&#xD;
&#xD;
Private Sub AllocateValue  'SelectionChanged Event:&#xD;
	&#xD;
	If  IsContainerEmpty Then &#xD;
			Me.SelectedItem = ""&#xD;
			Me.SelectedIndex = -1&#xD;
	Else&#xD;
			Me.SelectedItem = container(ListBox0.selectedindex)&#xD;
			Me.SelectedIndex = ListBox0.selectedindex&#xD;
	End If&#xD;
	triggerEvent("OnNewSelection")			&#xD;
	&#xD;
End Sub&#xD;
&#xD;
&#xD;
Public Sub ClearItems	&#xD;
&#xD;
	ReDim container(0)&#xD;
	ListBox0.setItems(container)&#xD;
	ListBox0.selectedindex = 0&#xD;
	&#xD;
End Sub&#xD;
&#xD;
&#xD;
Public Sub AddItems (ByVal externalArray As Omron.Hmi.SymbolManagement.PrimitiveArray1DSymbol(Of String) )	 'To be used with the specific NA global variable type String() (NA native)	&#xD;
&#xD;
		ReDim container(externalArray.Length) &#xD;
		Dim i As Integer&#xD;
		For i = 0 To (externalArray.Length - 1)&#xD;
			container(i) = externalArray(i)&#xD;
		Next&#xD;
		ListBox0.setItems(container)&#xD;
		ListBox0.selectedindex = 0&#xD;
		&#xD;
End Sub &#xD;
&#xD;
&#xD;
Public Sub AddItems (ByVal externalArray As String() )	'To be used with local variables declared in the VB script as String()&#xD;
		&#xD;
		ReDim container(externalArray.Length) &#xD;
		container = ToObjectArray(externalArray)&#xD;
		ListBox0.setItems(container)&#xD;
		ListBox0.selectedindex = 0&#xD;
		&#xD;
End Sub &#xD;
&#xD;
&#xD;
Private Function ToObjectArray(Of T) (source As T()) As Object()&#xD;
	&#xD;
            Dim result(source.Length - 1) As Object&#xD;
            Array.Copy(source, result, source.Length)&#xD;
            Return result&#xD;
			&#xD;
End Function&#xD;
&#xD;
&#xD;
Function IsContainerEmpty() As Boolean&#xD;
	If (container(0) = "") And (container.Length = 1)&#xD;
		Return True&#xD;
	End If&#xD;
	Return False&#xD;
End Function&#xD;
</Text></CodeEditorModel>