{"CLs":[{"__type":"LD","Var":"bGetMACDone"},{"__type":"IST","EID":"597d16c8-f1a8-483e-8bf4-bf6d0c036f91","H":283.83333333333337,"Ix":1,"TXT":"\u0009IF NOT MQTT_Connected  then\u000d\u000a\u0009\u0009TimerConnection(In:=NOT TimerReConnection.Q  AND _EIP_EtnOnlineSta, PT:=T#10s); \u000d\u000a\u0009\u0009TimerReConnection(In:=TimerConnection.Q ,PT:=T#5s) ;\u000d\u000a\u0009\u0009Connect:=TimerConnection.q;\u000d\u000a\u0009ELSIF MQTT_Connected AND TimerConnection.Q THEN\u000d\u000a\u0009\u0009TimerConnection(In:=FALSE);\u000d\u000a\u0009\u0009TimerReConnection(In:=FALSE);\u000d\u000a\u0009\u0009Connect:=TRUE;\u000d\u000a\u0009END_IF;","W":771,"X":1}],"LRI":2,"RRI":3,"VLs":[]}
{"CLs":[{"__type":"IST","EID":"c4b8eb29-f2d9-4bbf-82c3-1e556f10119e","H":543,"TXT":"\u000d\u000a\/\/Hostname:='81.2.252.112' ; \/\/ Aruba.IT\u000d\u000aHostname:='167.86.120.133' ; \/\/ Contabo\u000d\u000a \u000d\u000a \u000d\u000a CASE  uiRegStage OF\u000d\u000a\u0009 \u000d\u000a\u0009 2:\u000d\u000a\u0009  \/\/  Send Demo register request\u000d\u000a\u000d\u000a \u0009\u0009\/\/Get the demo number\u000d\u000a \u0009\u0009strDemoNumber:=DemoCaseID.DemoCaseNumber;\u000d\u000a \u0009\u0009\/\/strClientID:=CONCAT(ClientID,'_',strDemoNumber);\u000d\u000a\u0009\u0009strClientID:=ClientID;\u000d\u000a\u0009\u0009\u000d\u000a  \u000d\u000a\u0009\u0009\/\/ LWT configuration \u000d\u000a\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009 \/\/ Generate the OFFLINE  message\u000d\u000a\u0009\u0009Clear(jsBuffer);\u000d\u000a\u0009 \u0009JSON_STRING('ID',strClientID,jsBuffer);\u000d\u000a\u0009 \u0009JSON_STRING('Status', 'OFFLINE' , jsBuffer); \u000d\u000a\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u000d\u000a\u0009\u0009LWTdata.WillMsg:= JSONBuild(jsBuffer); \u000d\u000a\u0009\u0009LWTdata.WillTopic:='OnlineStatus';\u000d\u000a\u0009\u0009LWTdata.WillQoS:=1;\u000d\u000a\u0009\u0009LWTdata.WillRetain:=TRUE;\u000d\u000a\u0009\u0009LWTdata.WillFlag:=TRUE;\u000d\u000a\u0009\u0009\u000d\u000a\u0009\u0009IF MQTT_Connected THEN\u000d\u000a\u0009\u0009\u000d\u000a\u0009\u0009\u0009IF bRegister THEN\u000d\u000a\u0009\u0009\u0009\u0009strTopic:='RegisterDemo' \u0009;\u000d\u000a\u0009\u0009\u0009\u0009uiRegStage:=10;\u000d\u000a\u0009\u0009\u0009ELSIF  bUpdateStatus THEN\u000d\u000a\u0009\u0009\u0009\u0009strTopic:='UpdateStatus' \u0009;\u000d\u000a\u0009\u0009\u0009\u0009uiRegStage:=10;\u000d\u000a\u0009\u0009\u0009END_IF;\u000d\u000a\u0009\u0009\u0009\u000d\u000a\u0009\u0009END_IF;\u000d\u000a\u0009\u0009\u000d\u000a\u0009 \u000d\u000a\u0009 10:  \/\/ Generate the Register request\u000d\u000a\u0009 \u0009\u0009bSubscribe:=TRUE;\u000d\u000a\u0009 \u0009\u0009strSubsTopic:=CONCAT(strClientID ,'\/DeployStatus');\u000d\u000a\u0009\u0009\u0009strURLTopic:=CONCAT(strClientID ,'\/URL');\u000d\u000a\u0009\u0009\u0009strQRTopic:=CONCAT(strClientID ,'\/QR');\u000d\u000a\u0009\u0009\u0009\/\/ IF  bRegister THEN\u000d\u000a\u0009 \u000d\u000a\u0009\u0009 \u0009\u0009Clear(jsBuffer);\u000d\u000a\u0009\u0009\u0009\u0009JSON_STRING('DemocaseID',strClientID,jsBuffer);\u000d\u000a\u0009\u0009\u0009\u0009JSONObj('OwnerData',jsBuffer);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_STRING('Owner', DemoOwner.OwnerName , jsBuffer);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_STRING('email', DemoOwner.email , jsBuffer);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_STRING('NSC', DemoOwner.Country , jsBuffer);\u000d\u000a\u0009\u0009\u0009\u0009JSONCloseObj(jsBuffer);\u0009\u000d\u000a\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009strMsg:= JSONBuild(jsBuffer); \u000d\u000a\u0009\u0009\u0009\u0009\/\/strTopic:='RegisterDemo' \u0009;\u000d\u000a\u0009\u0009\u0009\u0009bPublish:=TRUE;\u000d\u000a\u000d\u000a\u0009\u0009\u0009\u0009uiRegStage:=15;\u000d\u000a\u0009\u0009\u000d\u000a\u0009 \u0009\u0009\/\/END_IF;\u0009\u000d\u000a\u0009 \u000d\u000a\u0009 15: \u0009\/\/ Democase Login, try to find out at remote DB\u000d\u000a\u0009 \u000d\u000a\u0009\u0009\u0009\u0009IF Log_Publish.Done THEN\u000d\u000a\u0009\u0009\u0009\u0009\u0009bPublish:=FALSE;\u000d\u000a\u0009\u0009\u0009\u0009\u0009bRegister:=FALSE;\u000d\u000a\u0009\u0009\u0009\u0009\u0009bUpdateStatus:=FALSE;\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009\u0009\/\/ Generate the Online TRUE message\u000d\u000a\u0009\u0009\u0009\u0009\u0009Clear(jsBuffer);\u000d\u000a\u0009 \u0009\u0009\u0009\u0009JSON_STRING('ID',strClientID,jsBuffer);\u000d\u000a\u0009 \u0009\u0009\u0009\u0009JSON_STRING('Status', 'ONLINE' , jsBuffer); \u000d\u000a\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009\u0009strTopic:='OnlineStatus' ;\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009\u0009strMsg:= JSONBuild(jsBuffer); \u000d\u000a\u0009\u0009\u0009\u0009\u0009uiRegStage:=18 ;\u000d\u000a\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009ELSIF \u0009Log_Publish.Error THEN\u000d\u000a\u0009\u0009\u0009\u0009\u0009bPublish:=FALSE;\u000d\u000a\u0009\u0009\u0009\u0009\u0009uiRegStage:=9001;\/\/\u000d\u000a\u0009\u0009\u0009\u0009\u0009dwExitCode:=Log_Publish.ErrorIDEx;\u000d\u000a\u0009\u0009\u0009\u0009END_IF;\u0009\u0009\u000d\u000a\u0009 \u000d\u000a\u000918: \/\/\u000d\u000a\u0009\u0009\u0009\u0009bPublish:=TRUE;\u000d\u000a\u0009\u0009\u0009\u0009uiRegStage:=20 ;\u000d\u000a\u0009 \u0009\u000d\u000a\u000920: \/\/ \u0009\u000d\u000a\u000d\u000a\u0009\u0009\u0009\u0009IF Log_Publish.Done THEN \/\/ Sent Online Status OK.\u000d\u000a\u0009\u0009\u0009\u0009\u0009bPublish:=FALSE;\u000d\u000a\u0009\u0009\u0009\u0009\u0009uiRegStage:=2 ;  \/\/30 ;\u000d\u000a\u0009\u0009\u0009\u0009ELSIF \u0009Log_Publish.Error THEN\u000d\u000a\u0009\u0009\u0009\u0009\u0009bPublish:=FALSE;\u000d\u000a\u0009\u0009\u0009\u0009\u0009uiRegStage:=9002;\u000d\u000a\u0009\u0009\u0009\u0009\u0009dwExitCode:=Log_Publish.ErrorIDEx;\u000d\u000a\u0009\u0009\u0009\u0009END_IF;\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u000d\u000a\u0009\u000d\u000a END_CASE ;\u000d\u000a \u000d\u000a ","W":839}],"LRI":1,"RRI":2,"VLs":[]}
