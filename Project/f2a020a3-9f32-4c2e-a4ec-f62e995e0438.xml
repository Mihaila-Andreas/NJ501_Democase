{"CLs":[{"__type":"IST","EID":"6c4f62cf-f089-4803-b4f5-f3796a750e8d","H":533,"TXT":"(**************************************************************\u000d\u000a*\u0009strAdminData - Active Alarms \u000d\u000a**************************************************************)\u000d\u000a\u000d\u000a\u000d\u000ax_Count[1](Clk:=UNActiveAlarms_Done ) ;\u000d\u000a\u000d\u000a\u000d\u000aIF  UNActiveAlarms_Done and UNNumberOfActiveAlarms >0 THEN\u000d\u000a\u000d\u000a\u0009\/\/Admin \/ Alarms active\u000d\u000a\u0009Clear(jsBUFFER);\u000d\u000a\u000d\u000a\u0009\u0009\u0009JSONObj('Admin',jsBUFFER);\u0009\u0009\u0009\u000d\u000a\u000d\u000a\u0009\u0009\u0009\u0009JSONList(jsBUFFER,'ActAlm');\u000d\u000a\u0009\u0009\u0009\u0009\u0009\/\/list  first new event\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_DINT('ID', UNActiveAlarmsArray[0].EventType.ID,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_DINT('Category', UNActiveAlarmsArray[0].EventType.Category ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_STRING('Msg', UNActiveAlarmsArray[0].EventType.Message ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_BOOL('Active', UNActiveAlarmsArray[0].Active ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSON_DATE('Time'\u0009, UNActiveAlarmsArray[0].OccuredTime     ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009\/\/list  simultaneous new events\u000d\u000a\u0009\u0009\u0009\u0009IF UNNumberOfActiveAlarms >1 THEN\u000d\u000a\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009\u0009FOR idx:=1 TO  UNNumberOfActiveAlarms  -1 do\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSONAdd(jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009JSON_DINT('ID', UNActiveAlarmsArray[idx].EventType.ID,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009JSON_DINT('Category', UNActiveAlarmsArray[idx].EventType.Category ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009JSON_STRING('Msg', UNActiveAlarmsArray[idx].EventType.Message ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009JSON_BOOL('Active', UNActiveAlarmsArray[idx].Active ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009JSON_DATE('Time'\u0009, UNActiveAlarmsArray[idx].OccuredTime     ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009END_FOR;\u000d\u000a\u0009\u0009\u0009\u0009END_IF;\u000d\u000a\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009JSONCloseList(jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009JSONCloseObj(jsBUFFER);\u0009\u000d\u000a\u0009\u0009 \u000d\u000a\u0009\u0009  strAdminActiveAlarms:=JSONBuild(jsBUFFER);\u000d\u000a\u0009\u0009  \/\/mqttUpdateActiveAlm:=TRUE;\u000d\u000a\u0009\u0009  \u000d\u000a\u000d\u000aELSIF (UNActiveAlarms_Done AND  UNNumberOfActiveAlarms =0 )THEN\u000d\u000a\u000d\u000a\u0009\/\/Admin \/ Alarms active\u000d\u000a\u0009\u0009Clear(jsBUFFER);\u000d\u000a\u000d\u000a\u0009\u0009\u0009\u0009JSON_INT('Admin',1,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\/\/JSONObj('Admin',jsBUFFER);\u0009\u0009\u0009\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSONObj ('ActAlm', jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009\/\/list  first new event\u000d\u000a\u0009\u0009\u0009\u0009\u0009\u0009JSON_STRING('Msg', 'No active alarms' ,jsBUFFER);\u000d\u000a\u0009\u0009\u0009\u0009\u0009JSONCloseObj (jsBUFFER);\u000d\u000a\u000d\u000a\u0009\u0009strAdminActiveAlarms:=JSONBuild(jsBUFFER);\u000d\u000a\u0009\u0009\/\/mqttUpdateActiveAlm:=TRUE;\u000d\u000a\u000d\u000aEND_IF; \u000d\u000a\u000d\u000a;","W":728.5}],"LRI":1,"RRI":2,"VLs":[]}
